C	PROGRAM QKAREA
C	   *QUICK AREA*
C	   TO ILLUSTRATE THE USE OF THE LONGLEY-RICE MODEL
C	     IN THE AREA PREDICTION MODE
C
C	   INPUT IS IN 10-COL FIELDS, THE FIRST OF WHICH IS 
C	     A SEQUENCE OF DIGITS
C	   IN PARTICULAR,
C	     COL 1 IS THE *EXECUTE* COLUMN--A NON-ZERO DIGIT
C	   	WILL FORCE OUTPUT
C	     COL 2 INDICATES THE CARD TYPE--
C		  	     COL
C		  	     12	     11,...
C	       STOP-	     X0	        (OR A BLANK CARD)
C	       TITLE-	     X1		(NEXT CARD HAS 60-COL TITLE)
C	       DISTANCES-    X2	     D0,D1,DS1,D2,DS2
C	       RELIABILITY-  X3V     QT,QL
C	       CONFIDENCE-   X4	     QC1,QC2,...
C	       ENVIRONMENT-  X5C     DH,N0,ZS,EPS,SGM
C	       SYSTEM-	     X6NPSS  FMHZ,HG1,HG2
C	       (ALTERNATE)   X7NPSS  FMHZ,HG1,HG2,DH,NS,EPS,SGM
C	       EXECUTE-      X8
C	       RESET-	     X9
C
	COMMON/PROP/KWX,AREF,MDP,DIST,HG(2),WN,DH,ENS,GME,ZGND,
     X     HE(2),DL(2),THE(2)
	   COMPLEX ZGND
	COMMON/PROPV/LVAR,SGC,MDVAR,KLIM
C
	COMMON/PROPA/DLSA,DX,AEL,AK1,AK2,AED,EMD,AES,EMS,DLS(2),DLA,THA
	COMMON/SAVE/SAVE(50)
C
	DIMENSION JIN(6),XIN(7)
	DIMENSION ITL(15)
	DIMENSION KST(2)
	DIMENSION QC(7),ZC(7),XLB(7)
C
	LOGICAL WQIT,WCON,WTL
C
C	   THE I/O UNITS ARE DEFINED HERE
	DATA KIN,KOT/5,6/
C
	DATA GMA/157E-9/
C
	DATA DB/8.685890/
	DATA AKM/1000./
C
	 WQIT=.FALSE.
	 WCON=.TRUE.
	 GO TO 190
C
  10	 CONTINUE
C	   READ INPUT SEQUENCE
C
1000	FORMAT(6I1,4X,7F10.0)
1001	FORMAT(15A4)
C
	 JIN(1)=0
	 JIN(2)=0
	 READ(KIN,1000) JIN,XIN
	 WCON=JIN(1) .EQ. 0
	 JQ=JIN(2)
	 IF(JQ .NE. 0)
     X      GO TO (110,120,130,140,150,160,170,180,190),JQ
C
	    WQIT=.TRUE.
	  GO TO 20
 110	    CONTINUE
	    READ(KIN,1001) ITL
	    WTL=.TRUE.
	  GO TO 20
 120	    CONTINUE
	    XIN(1)=DIM(XIN(1),0.)
	    Q=XIN(2)-XIN(1)
	    IF(Q .GT. 0.) GO TO 121
	       IF(XIN(1) .EQ. 0.) GO TO 128
	       D0=XIN(1)
	       DS=0.
	       DSC=0.
	       ND=1
	       NDC=0
	     GO TO 128
 121	       IF(XIN(3) .LE. 0.) XIN(3)=AMAX1(1.,AINT(Q/20.+0.5))
	       IF(XIN(1) .LE. 0.) XIN(1)=XIN(3)
	       D0=XIN(1)
	       DS=XIN(3)
	       DSC=DS
	       ND=DIM(XIN(2),XIN(1))/DS+1.75
	       NDC=0
	     IF(XIN(4) .LE. XIN(2)) GO TO 128
	       IF(XIN(5) .LE. 0.) XIN(5)=5.*XIN(3)
	       DSC=XIN(5)
	       JQ=(XIN(4)-XIN(2))/DSC+0.75
	       NDC=ND
	       ND=ND+JQ
 128	  GO TO 20
 130	    CONTINUE
	    MDVAR=MIN0(JIN(3),3)
	    LVAR=MAX0(LVAR,4)
	    QT=50.
	    QL=50.
	    ZT=0.
	    ZL=0.
	    IF(XIN(1) .LE. 0.) GO TO 131
	       QT=XIN(1)
	       ZT=QERFI(QT/100.)
 131	    IF(XIN(2) .LE. 0.) GO TO 138
	       QL=XIN(2)
	       ZL=QERFI(QL/100.)
 138	  GO TO 20
 140	    CONTINUE
	    NC=0
	    DO 141 JC=1,7
	      IF(XIN(JC) .LE. 0.) GO TO 141
	      NC=NC+1
	      QC(NC)=XIN(JC)
	      ZC(NC)=QERFI(QC(NC)/100.)
 141	    CONTINUE
	    IF(NC .GT. 0) GO TO 148
	       NC=1
	       QC(1)=50.
	       ZC(1)=0.
 148	  GO TO 20
 150	    CONTINUE
	    IF(JIN(3) .LE. 0) GO TO 151
	       KLIM=JIN(3)
	       LVAR=5
 151	    IF(XIN(1) .GE. 0.) DH=XIN(1)
	    IF(XIN(2) .LE. 0.) GO TO 152
	       EN0=XIN(2)
	       ZSYS=XIN(3)
 152	    IF(XIN(4) .LE. 0.) GO TO 158
	       EPS=XIN(4)
	       SGM=XIN(5)
 158	  GO TO 20
 160	    CONTINUE
	    IF(JIN(3) .EQ. 1) GO TO 161
	       IPOL=MIN0(JIN(4),1)
	       KST(1)=MIN0(JIN(5),2)
	       KST(2)=MIN0(JIN(6),2)
 161	    IF(XIN(1) .GT. 0.) FMHZ=XIN(1)
	    IF(XIN(2) .GT. 0.) HG(1)=XIN(2)
	    IF(XIN(3) .GT. 0.) HG(2)=XIN(3)
	  GO TO 20
 170	    CONTINUE
	    IF(JIN(3) .EQ. 1) GO TO 171
	       IPOL=MIN0(JIN(4),1)
	       KST(1)=MIN0(JIN(5),2)
	       KST(2)=MIN0(JIN(6),2)
 171	    IF(XIN(1) .GT. 0.) FMHZ=XIN(1)
	    IF(XIN(2) .GT. 0.) HG(1)=XIN(2)
	    IF(XIN(3) .GT. 0.) HG(2)=XIN(3)
	    IF(XIN(4) .GE. 0.) DH=XIN(4)
	    IF(XIN(5) .LE. 0.) GO TO 172
	       EN0=XIN(5)
	       ZSYS=0.
 172	    IF(XIN(6) .LE. 0.) GO TO 178
	       EPS=XIN(6)
	       SGM=XIN(7)
 178	  GO TO 20
 180	    CONTINUE
	    WCON=.FALSE.
	  GO TO 20
 190	    CONTINUE
	    FMHZ=100.
	    HG(1)=3.
	    HG(2)=3.
	    DH=90.
	    EN0=301.
	    ZSYS=0.
	    EPS=15.
	    SGM=0.005
	    IPOL=1
	    KST(1)=0.
	    KST(2)=0.
	    KLIM=5
	    MDVAR=3
	    LVAR=5
	    NC=3
	    QC(1)=50.
	    QC(2)=90.
	    QC(3)=10.
	    QT=50.
	    QL=50.
	    ZC(1)=0.
	    ZC(2)=-1.28155
	    ZC(3)= 1.28155
	    ZT=0.
	    ZL=0.
	    D0=10.
	    DS=10.
	    DSC=50.
	    ND=22
	    NDC=15
	    WTL=.FALSE.
C
 20	 CONTINUE
	 IF(WCON) GO TO 30
C
C	   EXECUTION 
C
	 KWX=0
	 CALL QLRPS(FMHZ,ZSYS,EN0,IPOL,EPS,SGM)
	 CALL QLRA(KST,-1,-1)
C
C	   WRITE HEADING
c commented out line 2001 and replaced it with a space. 8/2/94
c the original intent off line 2001 was to force a new page (formfeed)
c on a printer. However, the old style of a 1 then a 0 in the first column
c is no longer used by printers. Also I am not sure how to generate
c a formfeed with a format statement in fortran.
c
C 2001	FORMAT(1H1/1H0)
2001	format(' ')
2002	FORMAT(1H )
2010	FORMAT(3X,
     .62HAREA PREDICTIONS FROM THE LONGLEY-RICE MODEL, VERSION 1.2.1   )
2011	FORMAT(3X,15A4)
2015	FORMAT(12X,9HFREQUENCY,F12.0,4H MHZ)
2016	FORMAT(6X,15HANTENNA HEIGHTS,2F8.1,2H M)
2017	FORMAT(4X,17HEFFECTIVE HEIGHTS,2F8.1,
     .     12H M  (SITING=,I1,1H,,I1,1H))
2018	FORMAT(5X,16HTERRAIN, DELTA H,F12.0,2H M)
C
	 WRITE(KOT,2001)
	 IF(WTL) GO TO 211
	 WRITE(KOT,2010)
	 GO TO 212
 211	 WRITE(KOT,2011) ITL
 212	 WRITE(KOT,2002)
 	 WRITE(KOT,2002)
	 WRITE(KOT,2015) FMHZ
	 WRITE(KOT,2016) HG
	 WRITE(KOT,2017) HE,KST
	 WRITE(KOT,2018) DH
	 WRITE(KOT,2002)
C
2021	FORMAT(3X,4HPOL=,I1,6H, EPS=,F3.0,6H, SGM=,F6.3,4H S/M)
2022	FORMAT(3X,5HCLIM=,I1,5H, NO=,F4.0,5H, NS=,F4.0,4H, K=F6.3)
C
	 Q=GMA/GME
	 WRITE(KOT,2021) IPOL,EPS,SGM
	 WRITE(KOT,2022) KLIM, EN0,ENS,Q
	 WRITE(KOT,2002) 
C
2030	FORMAT(3X,22HSINGLE-MESSAGE SERVICE)
2031	FORMAT(3X,18HACCIDENTAL SERVICE/
     .     8X,F5.1,27H PER CENT TIME AVAILABILITY)
2032	FORMAT(3X,14HMOBILE SERVICE/
     .     8X,21HREQUIRED RELIABILITY-,F5.1,9H PER CENT)
2033	FORMAT(3X,17HBROADCAST SERVICE/
     .     8X,21HREQUIRED RELIABILITY-,F5.1,14H PER CENT TIME/
     .     29X,F5.1,19H PER CENT LOCATIONS)
C
	 IF(MDVAR .NE. 0)
     X	    GO TO (231,232,233),MDVAR
C
	    WRITE(KOT,2030)
	  GO TO 238
  231	    WRITE(KOT,2031) QT
	  GO TO 238
  232	    WRITE(KOT,2032) QT
	  GO TO 238
  233	    WRITE(KOT,2033) QT,QL
  238	 WRITE(KOT,2002)
C
2040	FORMAT(3X,
     .62HESTIMATED QUANTILES OF BASIC TRANSMISSION LOSS(DB)            )
2041	FORMAT(7X,4HDIST,5X,4HFREE,4X,15HWITH CONFIDENCE/
     .	   8X,2HKM,5X,6HSPACE ,7F8.1)
2045	FORMAT(2X,3F9.1,6F8.1)
C
C	   COMPUTE AND PRINT VALUES
	 WRITE(KOT,2040)
	 WRITE(KOT,2002)
	 WRITE(KOT,2041) (QC(JC),JC=1,NC)
	 WRITE(KOT,2002)
	 DT=DS
	 D=D0
	 DO 240 JD=1,ND
	   LVAR=MAX0(1,LVAR)
	   CALL LRPROP(D*AKM)
	   FS=DB*ALOG(2.*WN*DIST)
	   DO 241 JC=1,NC
 241	   XLB(JC)=FS+AVAR(ZT,ZL,ZC(JC))
	   WRITE(KOT,2045) D,FS,(XLB(JC),JC=1,NC)
	   IF(JD .EQ. NDC) DT=DSC
	   D=D+DT
 240	 CONTINUE
C
2081	FORMAT(3X,
     .62H**WARNING- SOME PARAMETERS ARE NEARLY OUT OF RANGE.           /
     .     3X,
     .62H  RESULTS SHOULD BE USED WITH CAUTION.                        )
2082	FORMAT(3X,
     .62H**NOTE- DEFAULT PARAMETERS HAVE BEEN SUBSTITUTED              /
     .     3X,
     .62H  FOR IMPOSSIBLE ONES.                                        )
2083	FORMAT(3X,
     .62H**WARNING- A COMBINATION OF PARAMETERS IS OUT OF RANGE.       /
     .	   3X,
     .62H  RESULTS ARE PROBABLY INVALID.                               )
2084	FORMAT(3X,
     .62H**WARNING- SOME PARAMETERS ARE OUT OF RANGE.                  /
     .     3X,
     .62H  RESULTS ARE PROBABLY INVALID.                               )
C
	 IF(KWX .EQ. 0) GO TO 28
C
C	   PRINT ERROR MESSAGES
	    WRITE(KOT,2002)
	    GO TO (281,282,283,284),KWX
  281	    WRITE(KOT,2081) 
	  GO TO 28
  282	    WRITE(KOT,2082) 
	  GO TO 28
  283	    WRITE(KOT,2083) 
	  GO TO 28
  284       WRITE(KOT,2084)
  28     CONTINUE
C
   30    CONTINUE
	 IF(.NOT. WQIT) GO TO 10
C
	 STOP
	END

